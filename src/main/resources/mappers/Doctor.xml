<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mna.homespital.dao.DoctorDAO">
    <!--    <insert id="insertDoctor" parameterType="Doctor">-->
    <!--        <![CDATA[-->
    <!--        insert into `user`(user_email, user_password, user_name, user_registration_number,-->
    <!--                           user_phone, user_address)-->
    <!--        values (#{user_email}, #{user_password}, #{user_name}, #{user_registration_number},-->
    <!--                #{user_phone}, #{user_address})-->
    <!--        ]]>-->
    <!--    </insert>-->
    <select id="queryDoctor" resultType="Doctor" parameterType="Map">
        <![CDATA[
        select *
        from (select @rownum:=@rownum+1 rnum, tot.*
              from (select * from doctor) tot,
                  (select @rownum := 0) temp) sub
        where rnum between #{startrow} and #{startrow} + 9
          and doctor_diagnosis_type = #{doctor_diagnosis_type}
        ]]>
    </select>

    <select id="doctorAmount" resultType="Integer">
        <![CDATA[
        select count(doctor_number)
        from doctor;
        ]]>
    </select>

    <!--   소연 : 의사 정보 가져오는 쿼리문  -->
    <select id="docInfo" resultType="Doctor" parameterType="int">
        <![CDATA[
        select *
        from doctor
        where doctor_number = #{doctor_number}
        ]]>
    </select>

    <!--의사명 및 병원명 검색 태영   -->
    <select id="searchDoh" resultType="Doctor" parameterType="String">
        <![CDATA[
        select *
        from doctor
        where doctor_name like concat('%', #{keyword}, '%')
           or replace(hospital_name, ' ', '') like concat('%', #{keyword}, '%')
        ]]>
    </select>

    <!--   준근 : 의사 스케쥴에 대한 정보 가져오기 getDocScheduleInfo-->
    <select id="getDocScheduleInfo" resultType="HashMap" parameterType="int">
        <![CDATA[
        SELECT @rownum:=@rownum+1 as waitingNum, s.*
        FROM doctor_schedule s
        WHERE (@rownum := 0)=0 and doctor_number = #{doctor_number};
        ]]>
    </select>

    <!-- 선택된 진료과의 닥터 정보들 가져오기(준근) -->
    <select id="selectDoctor" resultType="Doctor" parameterType="String">
        <![CDATA[
        select *
        from doctor
        where doctor_diagnosis_type = #{doctor_diagnosis_type}
        ]]>
    </select>


</mapper>
