<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mna.homespital.dao.DoctorDAO">

    <!--가영: 회원가입 인서트-->
<!--    <insert id="insertDoctorMember" parameterType="doctor">-->
<!--        <![CDATA[-->
<!--        insert into `doctor`(doctor_email, doctor_password, hospital_file_name,hospital_name, hospital_telephone, doctor_phone, doctor_name,doctor_valid_number, doctor_profile_image_name, hospital_business_number,zip_code, street_address, detail_address, doctor_diagnosis_type,working_time, lunch_time, holiday, hospital_fax, hospital_url, doctor_introduction)-->
<!--        values (#{doctor_email}, #{doctor_password}, 'a','a', 'a', 'a', 'a',-->
<!--                'a','a','a',-->
<!--               'a', 'a', 'a', 'a',-->
<!--                'a', 'a', 'a', 'a', 'a', 'a')-->
<!--        ]]>-->
<!--    </insert>-->

    <insert id="insertDoctorMember" parameterType="doctor">
        <![CDATA[
        insert into `doctor`(doctor_email, doctor_password, doctor_phone, doctor_name,doctor_valid_number, doctor_profile_image_name, hospital_business_number,zip_code, street_address, detail_address, doctor_diagnosis_type,working_time, lunch_time, holiday, hospital_fax, hospital_url, doctor_introduction)
        values (#{doctor_email}, #{doctor_password}, #{doctor_phone}, #{doctor_name},
                #{doctor_valid_number},#{doctor_profile_image_name},#{hospital_business_number},
                #{zip_code}, #{street_address}, #{detail_address}, #{doctor_diagnosis_type},
                REPLACE(#{working_time}," ",""), #{lunch_time}, #{holiday}, #{hospital_fax}, #{hospital_url}, #{doctor_introduction})
        ]]>
    </insert>

<!--가영: 의사정보 가져옴-->
    <select id="DoctorQueryMember" resultType="Doctor" parameterType="String">
        <![CDATA[
        select *
        from doctor
        where doctor_email = #{doctor_email}
        ]]>
    </select>

    <select id="queryDoctor" resultType="Doctor" parameterType="int">
        <![CDATA[
        select *
        from (select @rownum:=@rownum+1 rnum, tot.*
              from (select * from doctor) tot,
                  (select @rownum := 0) temp) sub
        where rnum between #{startrow} and #{startrow} + 9
        ]]>
    </select>

    <select id="doctorAmount" resultType="Integer">
        <![CDATA[
        select count(doctor_number)
        from doctor;
        ]]>
    </select>

    <!--   소연 : 의사 정보 가져오는 쿼리문  -->
    <select id="docInfo" resultType="Doctor" parameterType="int">
        <![CDATA[
        select *
        from doctor
        where doctor_number = #{doctor_number}
        ]]>
    </select>

    <!--의사명 및 병원명 검색 태영   -->
    <select id="searchDoh" resultType="Doctor" parameterType="String">
        <![CDATA[
            select * from doctor where doctor_name like concat('%', #{keyword}, '%') or replace(hospital_name,' ','') like concat('%', #{keyword}, '%')
        ]]>
    </select>

    <!--   준근 : 의사 스케쥴에 대한 정보 가져오기 getDocScheduleInfo-->
    <select id="getDocScheduleInfo" resultType="HashMap" parameterType="int">
        <![CDATA[
        SELECT @rownum:=@rownum+1 as waitingNum, s.*
        FROM doctor_schedule s
        WHERE (@rownum := 0)=0 and doctor_number = #{doctor_number};
        ]]>
    </select>

</mapper>
